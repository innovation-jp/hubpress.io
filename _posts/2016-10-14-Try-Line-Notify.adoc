= Line Notify
:published_at: 2016-10-14
:hp-alt-title: TryLineNotify
:hp-tags: Tsukamoto,Line,Lambda,api
:hp-image: linescsh.png

今回は、世のマイクロサービスおじさんは皆大好きMartin Fowlerの設計償却線をDDD的視点から提示する」という記事を書く予定でしたが、
思えば自分の記事は毎回エモいのばっかりだなと気づき足踏みしていました。
そんな昨日（10/13）LINE Engineer Blogにポストされた、 http://developers.linecorp.com/blog/ja/?p=3784[コマンドラインから LINE にメッセージを送れる LINE Notify]
という記事がバズってるのを読み、早速やってみたところ死ぬほど簡単だったのでこちらを記事にします。


## まずコマンドラインで

上記事に書いてあるとおりです。


せっかくなので、.bashrcにエイリアスを設定して使いやすく

```bash
function sendline (){
    curl -X POST -H "Authorization: Bearer ${LINENOTIFYTOKEN}" -F "message=$1" $LINENOTIFYHOST
}
```
環境変数を設定します。
```bash
export LINENOTIFYTOKEN=************
export LINENOTIFYHOST=https://notify-api.line.me/api/notify
```

叩く
```bash
sendline '動作確認やで！'
```

image::linescsh.png[LINE screenshot]

来ました！


遅まきながらここで気づいたのが、送信元が「LINE Notify」と表示されるので、私信には使いにくいということ。
明らかにシステム通知っぽいものしか用途にならないと思いました。

とはいえ、我々エンジニアは既にSlackにどっぷり浸かっているため、システム通知を今更代替しようとも思わない。
他の職種の方々が使いそうなものは無いかなと考えたところ、

IMPORTANT: 「なんか、目標達成したときにLINEに送ったりしたらいいんじゃないか」

と思いましたので、Lambdaで作ってみました。


## AWS Lambdaで実装


仮にデイリーの目標となる数値を取得できるAPIを実装していたとします。
```python
API_URL='https://api.ourcompany.com/daily/point'
```

**「教えてもらえる環境かどうか」**というのは要素としてとても大きいですが、これも会社依存の問題なのでここでは置いておきます。




こちらからは以上です。
