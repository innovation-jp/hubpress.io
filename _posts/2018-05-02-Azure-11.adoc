= 執筆中
:hp-alt-title: Azure 11
:hp-tags: syoga, log, Azure, Circl CI, Azure Web Apps, Docker


はじめまして！未経験中途の新人、すももです。 +
初ブログでいろいろ困ってますが、GAS好きの亜美さんから教えてもらって、GASをちょろちょろイジってみたので初めての方向けに発表したいと思います！
 +
 +


image::/images/ami/20180502/1.png[]


image::/images/ami/20180502/2.png[]





##### まずはスプレッドシートからGASを実行するための基本操作から！


#*1.スプレッドシートからスクリプトエディタを開く*# 

・スプレッドシートを開いたら、メニューにある「ツール」をクリック +
・上から２番目「スクリプトエディタ」という表示があるのでクリック +
 + 
よし、開いたぞ！ +
 + 
ここに画像入れる +
 +


#*2.コードの編集*# 

・初期状態ではmyFunctionという関数が書かれているので、関数名を変えたり中身のコードを書いてみる +

```
function test() {
  Browser.msgBox('テスト');
}

```

* 注意点！ +
スプレッドシートは自動保存だが、スクリプトエディタは自動保存されないので、都度手動で保存が必要 +
（編集が保存されてない時は「コード.gs」の前に赤いアスタリスクマークが出ます）


#*3.では、試しに実行してみよう！*#

・スクリプトエディタのメニューからプルダウンで関数名選ぶ + 
（コード保存すると勝手に関数名のプルダウンに反映する） +
・「▶」(実行ボタン)を押すとGASが実行される +

* 注意点！ +
初回実行時は「承認が必要です」というダイアログが出る為、「許可を確認」をクリック +
↓
 +
次の画面でGoogleアカウントを選択 + 
↓
 +
最後に「許可」をクリックすると承認される +



わーい、GAS実行できたー！ +
 + 
ここに画像入れる


##### よし、GAS実行の準備ができたので +
##### さっそく作ってみよう！

#*今回作りたいもの*# +
毎日スプレッドシートを見ながら、IPアドレスがブラックリストに登録されていないかチェックするのですが、朝一やらないとやり忘れることがある...！ +
...なので、やり忘れていたら決まった時間にslackでお知らせしてほしい〜 +


#*お知らせ(slack)を送るまでの流れ*# +
　①スプレッドシート編集時に今日の日付を書き込む +
　②指定した時間に、シートに書き込まれている日付をチェックする +
　③書き込まれている日付が今日の日付でなければslackを送る +
　④送信先のslackbotにお知らせが届く +


*①-1.スプレッドシート編集時に今日の日付を書き込む（準備）*

```
// 現在の日時を取ってくる
var today = new Date();

// 紐づいているファイル自体をとってくる！
var ss = SpreadsheetApp.getActiveSpreadsheet();

// getSheetByNameで指定した名前のシートをとってくる
var sheet = ss.getSheetByName(today.getFullYear() + '年' + (today.getMonth() + 1) + '月');

// 指定したセルそのものを取ってくる！
var range = sheet.getRange('C1');

// 日付のみ入れる(2018年5月1日というような感じで)
var date = today.getFullYear() + '年' + (today.getMonth() + 1) + '月' + today.getDate() + '日';

```

