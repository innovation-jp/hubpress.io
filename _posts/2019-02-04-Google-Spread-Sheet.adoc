# GoogleSpreadSheetで文字列から数字のみを抽出する方法
:hp-alt-title: GoogleSpreadSheetで文字列から数字のみを抽出する方法
:hp-tags: ozasa, GoogleSpreadSheet, Excel

こんばんは。オザサです。 +
唐突ですが、シアトルにあるAmazonGoへ行ってきたので、 +
レポートしてみたいと思います！

## 困ったこと/したいこと

数値の分析とかしたいのに元データが文字列で表現されている！
このままだと加工できない！！
数値だけ抽出したい！！

image::http://tech.innovation.co.jp/images/ozasa/amazongo2018/amazongoFront.JPG[]






## 今回のデータ
Excelか何かのデータをインポートしたてみたいなイメージです。

## アウトプットイメージ
E列の数値を出すのが今回のメインです！

## 今回書いた式
[source, rust]
----
=LOOKUP(10^17,ARRAYFORMULA(LEFT(対象文字列,COLUMN($1:$1))*1))
----

## 解説
[source, rust]
----
COLUMN($1:$1)
----

数値だけの配列をセットすることができます。
1,2,3,4といった並びです。
見かけ上は「1」と表示されます。

[source, rust]
----
LEFT(対象文字列,COLUMN($1:$1))
----
対象文字列を左から切り出して配列化します。
この時点では文字列。

[source, rust]
----
LEFT(対象文字列,COLUMN($1:$1))*1
----
文字列に対して1をかけることで数値に転換します。
この時数値に直せないあたいは「#VALUE!」で表示されます。

これらをARRAYFORMULAを使い、
配列を横に展開した形で表現したものが下記画像です。

[source, rust]
----
=ARRAYFORMULA(LEFT(対象文字列,COLUMN($1:$1))*1)
----
ARRAYFORMULAを使いLEFTで取得した内容を配列データのまま扱います。

[source, rust]
----
=LOOKUP(10^18,対象配列))
----
対象配列から検索値の近似値を返します。
今回適当に百京としているので百京までは最大値が返ります。

## 詰まったところ
ExcelとGoogleSpreadSheetで仕様が違い、
ARRAYFORMULAを噛ませないとデータを配列として扱えないようです。
それを知るまで最初の数値しか抽出できなくて詰まりました。

## Excelだと
=LOOKUP(10^18,LEFT(対象文字列,COLUMN($1:$1))*1)
でそのままいけます。
こんな風に表示されてました。

う〜ん、
奥が深・・・そう！！

こちらからは以上です。
