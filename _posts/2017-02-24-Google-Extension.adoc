# GoogleExtensionで来客情報を取得した話し。
:hp-alt-title: GoogleExtension
:hp-tags: GoogleExtention,kohe,js,html


こんばんはこへです。


弊社では新人が毎朝GRIDYの来客情報を確認し、全社員の前で広報している。

私も自分が担当のときは毎朝GRIDYを確認し、朝会に備えている。

しかし、来客情報を確認してそれをいちいち紙にメモを取る行為は非効率的で非生産的だと感じたので*自動化*してみた。

## GRIDYから「今日の来客情報」のみを取得したい！


image::kohe/extention01.png[]

↑の画像の赤丸の情報を取得したい。

具体的に説明すると。
取得したい情報は上記画像の本日の日付の列にある(このブログでは本日を２３日とする）「来客」と言う文字が書いてある下の文字の情報が欲しいのである。

今回は *GoogleExtension*



[source, js]
----
chrome.tabs.query({active:true}, function(tab) {
    chrome.tabs.sendMessage(tab[0].id, {text:''}, function(response) {
        var url       = tab[0].url;
        console.log(response);
        var infoType = response.infotype;
        var content  = response.content;
        var count    = 0;
        jQuery.each(infoType, function(i, val) {
            if(val.match('来客')){
                 $("#info").append('<p>' + content[count] + '</p>');
            }
            count+=1;
        });
     });
});

----


```
chrome.tabs.query({active:true}, function(tab) {
    chrome.tabs.sendMessage(tab[0].id, {text:''}, function(response) {
        var url       = tab[0].url;
        console.log(response);
        var infoType = response.infotype;
        var content  = response.content;
        var count    = 0;
        jQuery.each(infoType, function(i, val) {
            if(val.match('来客')){
                 $("#info").append('<p>' + content[count] + '</p>');
            }
            count+=1;
        });
     });
});


```