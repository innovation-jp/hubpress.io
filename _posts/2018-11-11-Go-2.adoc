# Goのプロファイラを使おう！ その2
:hp-tags: NewTsukamoto, mac, Golang, pprof, CPUProfile

こんにちは。
エンジニアのNew塚本です。

最近、地元でお祭りがありました。午前中から呑めるっていいですね！


今回も、前回に引き続きプロファイラについてのお話をのせたいと思います。 +

====== 今回やる事

・プロファイリングデータを可視化する +
・遅い処理を改善する

====== 使用するプログラム
前回と同じプログラムを使用しました。 +
Azureキューストレージからデータを取得、ごにょごにょした処理後にDBにInsertして、Azureキューストレージからデータを削除するバッチ処理です。 


====== プロファイルデータの画像化

プログラムには、以下のコードが入っているのでバッチを実行すれば、プロファイルデータが出力されます。
++++
<pre style="font-family: Menlo, Courier">
f, _ := os.Create("test_track.profile")
pprof.StartCPUProfile(f)
defer pprof.StopCPUProfile()
</pre> 
++++


以下のコマンドを実行。
++++
<pre style="font-family: Menlo, Courier">
go tool pprof --svg ./tracking test_track.profile > track.svg
</pre> 
++++


track.svgが出力されるので、ブラウザで見てみ見ましょう。





====== まとめ
今回は、プロファイラを使ってみることが目的だったのでこれでOKとしました。 + 

プロファイラの一般的な使われ方は、遅い（性能要件を満たしていない）とか、アプリケーションの異常終了などの障害解析で使われるのではないでしょうか？ + 

製造している途中でもプロファイラを確認し、自信を持ってアプリをリリースする。そんな大人になりたいと思います。 + 

おわり。





