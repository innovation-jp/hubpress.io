# 拡張機能でGmailを全件既読にする（できるとは言っていない）
:published_at: 2017-03-03
:hp-alt-title: mark read all by Google Extension
:hp-tags: GoogleExtension, GoogleAppsScript, Gmail, Bigen

びげんです。

前回まで数学とかのお話をしていたのですが、 +
今回は流行りにのってGAS（GoogleAppScript)をいじります。 +
 +
といっても、今回のメインは

===== Execution API

です。 +

聞いたところによると、こいつを使えば外部から自作GASをぶっ叩けるとか！ +
*「じゃあ拡張機能を使って、ボタンひとつでGmailを全件既読にできるのではないか？」* +
と思い立ったので、実際にやってみました。 +

なお、結論からいうと拡張機能は*できませんでした*。 +
もう少し何かが足りない感じ・・・。 +

拡張機能での実現はできませんでしたが、 +
ローカルのページからボタンひとつで全件既読はできたので、 +
そこまでをご紹介します。

=== 手順
*①動かしたいGASを書く* +
*②Google API ConsoleにてExecution APIを有効にする* +
*③認証情報（クライアントID）を新たに作成する* +
*④ローカルサーバーからぶったたく* +

=== やってみる
===== ①動かしたいGASを書く
----
function markReadAll() {
 
  /* 検索条件を指定してGmailからスレッドを取り出す */
  var searchTerm = 'is:unread';
  var Threads = GmailApp.search(searchTerm, 0, 500);

  /* 全件既読をつける */
  for (i=0; i<Threads.length; i++){
    Threads[i].markRead();
  }
}
----
全件既読はコードとしては簡単。
未読のスレッドを取得して、.markReadってやるだけ。 +

===== ②Google API ConsoleにてExecution APIを有効にする +
Google API Consoleのライブラリから「Google Apps Script Execution API」を検索。


