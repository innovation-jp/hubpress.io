# PostgreSQLとMySQL、使うならどっち？ データベース専門家が8つの視点で徹底比較！という記事を読んだ
:hp-alt-title:PostgreSQLとMySQL、使うならどっち？ データベース専門家が8つの視点で徹底比較！という記事を読んだ
:hp-tags: Shirota, PostgresSQL, MySQL


|===
||PostgreSQL|MySQL|補足

|DDL操作のブロッキング
|発生するが、pg_repackという外部ツールを使えば、REINDEXや一部のALTER文を最小限のロックで実行可。
|バージョン5.6から、多くのDDL操作でトランザクション中でもテーブルへのブロックがかからないようになった。（ノンブロッキング）
|

|SELECT文パフォーマンス
|
|大量データのソート（ORDER BYして、テーブルの全データを取得する）のは遅い。ソートアルゴリズムがそれほど優れていない。新規10件、100件（Top n レコード）を取得するのは速い。
|

|UPDATE文パフォーマンス
|追記型アーキテクチャであり、INSERTに近い処理が行われ、変更前の行に削除フラグのようなものが立てられている。
|文字通り本当に変更前の行を上書きしている
|

|DELETE文パフォーマンス
|
|かつて、DELETE文は遅かった。データ削除後にセカンダリーインデックスを同期処理で貼り直していた。バージョン5.5からは、その処理はサーバがアイドル状態のときなどに行われる非同期処理になり、以前ほどDELETEが遅いということはなくなった。
|

|JOINアルゴリズム
|3種類ともサポート
|ネステッドループ結合のみ
|JOINアルゴリズムには、 +
* ネステッドループ結合（Nested Loop Join） +
* ハッシュ結合（Hash Join） +
* ソートマージ結合（Sort Merge Join） +
の3種類がある。 +
それぞれのユースケースは後述（※）

|トランザクション処理の分離レベル
|デフォルトはREAD-COMMITTEDであるが、 +
REPEATABLE-READにしたときのファントムリードの防ぎ方は、ネクストキーロックはせずに別の方法を用いていて、MySQLより優れていると言えるかもしれない。
|デフォルトがREPEATABLE-READであり、ファントムリードを避けるためネクストキーロックという仕組みを採用している。 +
（※ネクストキーロックとは、主キーのインクリメント先の値までロックをかける仕組み。）
|トランザクション処理の分離レベルは、 +
* SERIALIZABLE +
* REPEATABLE-READ +
* READ-COMMITTED +
* READ-UNCOMMITTED +
の4種類ある。 +
詳細は後述（※） +
 +
 
※ファントムリードとは、並行して動作している他のトランザクションが追加したデータが途中で見えてしまう現象
|===



ネステッドループ結合
結合されるテーブルのどちらかのデータ量が少なくて、もう一方が多いようなとき
もしくは、
インナーテーブル側がインデックススキャンを使えるとき

ハッシュ結合
結合対象のデータ量が多いときで、データがソートされていないとき

ソートマージ結合
結合対象のデータ量が多いときで、データが既にソートされているとき

